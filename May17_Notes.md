# Register Allocation - Graph Coloring and Linear Scan

## 1. 什么是我们的问题？

在这一节中，我们会讨论寄存器的分配问题。那么，问题是什么呢？

（1）在中间表示（Intermediate Representation, IR) 中， 例如LLVM,  为了将寄存器与代码分开，并使两者都更简单，我们假设有无限数量的寄存器。

（2） 但是在现实的设计中，我们只有有限数量的寄存器。所以我们需要用有限数量的真寄存器（Real Register) 去替换虚拟寄存器（Virtual Register)。但是，一个真实的寄存器在每个点只能替换一个虚拟寄存器。有时候，当我们没有足够的真寄存器，我们必须进行spill溢出处理。



## 2. 我们该如何优化

1. 通常情况下，我们会生成代码，优化无限数量的寄存器，然后再分配有限数量的寄存器（通常是4-32个）

2. 我们需要考虑两个部分，Allocation分配和Assignment分派

   <!--注意到：在编译器中，分配与分派是两个不同的概念-->

   
